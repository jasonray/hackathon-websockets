<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;15.&nbsp;&#25345;&#20037;&#21270;</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="HornetQ 2.1&#29992;&#25143;&#25163;&#20876;"><link rel="up" href="index.html" title="HornetQ 2.1&#29992;&#25143;&#25163;&#20876;"><link rel="previous" href="filter-expressions.html" title="Chapter&nbsp;14.&nbsp;&#36807;&#28388;&#22120;&#34920;&#36798;&#24335;"><link rel="next" href="configuring-transports.html" title="Chapter&nbsp;16.&nbsp;&#20256;&#36755;&#23618;&#30340;&#37197;&#32622;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;15.&nbsp;&#25345;&#20037;&#21270;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="filter-expressions.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="configuring-transports.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="persistence"></a>Chapter&nbsp;15.&nbsp;&#25345;&#20037;&#21270;</h2></div></div><div></div></div><p>&#26412;&#31456;&#25105;&#20204;&#23558;&#25551;&#36848;HornetQ&#30340;&#25345;&#20037;&#21270;&#25216;&#26415;&#65292;&#21253;&#25324;&#25345;&#20037;&#21270;&#30340;&#24037;&#20316;&#21407;&#29702;&#21644;&#37197;&#32622;&#26041;&#27861;&#12290;</p><p>HornetQ&#25317;&#26377;&#19968;&#20010;&#39640;&#24615;&#33021;&#30340;&#26085;&#24535;&#65288;journal&#65289;&#27169;&#22359;&#26469;&#22788;&#29702;&#25345;&#20037;&#21270;&#12290;&#22240;&#27492;&#23427;&#24182;&#19981;&#20381;&#36182;&#19968;&#20010;&#22806;&#37096;&#30340;&#25968;&#25454;&#24211;&#25110;&#31532;&#19977;&#26041;&#25345;&#20037;&#21270;&#20135;&#21697;&#12290;&#36825;&#20010;
        &#26085;&#24535;&#27169;&#22359;&#38024;&#23545;&#28040;&#24687;&#30340;&#22788;&#29702;&#36827;&#34892;&#20102;&#39640;&#24230;&#30340;&#20248;&#21270;&#12290;</p><p>&#25152;&#35859;HornetQ&#26085;&#24535;&#26159;&#19968;&#20010;<span class="emphasis"><em>&#21482;&#28155;&#21152;</em></span>&#31995;&#32479;&#12290;&#23427;&#30001;&#19968;&#32452;&#30913;&#30424;&#25991;&#20214;&#26500;&#25104;&#12290;&#27599;&#20010;&#25991;&#20214;&#37117;&#26159;&#39044;&#20808;&#21019;&#24314;&#22909;&#30340;&#24182;&#19988;
        &#22823;&#23567;&#26159;&#22266;&#23450;&#30340;&#12290;&#25991;&#20214;&#22312;&#21019;&#24314;&#26102;&#37117;&#36827;&#34892;&#20102;&#26684;&#24335;&#21270;&#12290;&#38543;&#30528;HornetQ&#19981;&#26029;&#22320;&#22788;&#29702;&#28040;&#24687;&#65292;&#22914;&#28040;&#24687;&#30340;&#22686;&#21152;&#12289;&#26356;&#26032;&#12289;&#21024;&#38500;&#31561;&#65292;&#19968;&#20010;&#20010;&#35760;&#24405;&#34987;&#28155;&#21152;
        &#21040;&#26085;&#24535;&#20013;&#12290;&#24403;&#19968;&#20010;&#26085;&#24535;&#25991;&#20214;&#20889;&#28385;&#26102;&#65292;&#26032;&#35760;&#24405;&#23601;&#20250;&#20889;&#21040;&#19979;&#19968;&#20010;&#25991;&#20214;&#12290;</p><p>&#30001;&#20110;&#23545;&#26085;&#24535;&#30340;&#20889;&#20837;&#21482;&#26159;&#23545;&#25991;&#20214;&#30340;&#28155;&#21152;&#65292;&#36825;&#26679;&#26377;&#25928;&#20943;&#23569;&#20102;&#38543;&#26426;&#23547;&#36947;&#30340;&#25805;&#20316;&#12290;&#32780;&#38543;&#26426;&#23547;&#36947;&#30340;&#25805;&#20316;&#26159;&#30913;&#30424;&#25805;&#20316;&#20013;&#26368;&#32791;&#26102;&#30340;&#25805;&#20316;&#12290;
        &#25152;&#20197;&#36825;&#31181;&#35774;&#35745;&#21487;&#20197;&#20351;&#30913;&#22836;&#30340;&#36816;&#21160;&#38477;&#21040;&#26368;&#20302;&#65292;&#25928;&#29575;&#26368;&#39640;&#12290;</p><p>&#32780;&#25991;&#20214;&#30340;&#22823;&#23567;&#26159;&#21487;&#20197;&#37197;&#32622;&#30340;&#12290;&#36825;&#20351;&#25105;&#20204;&#21487;&#20197;&#23558;&#25991;&#20214;&#22823;&#23567;&#37197;&#32622;&#20026;&#21018;&#22909;&#21344;&#28385;&#19968;&#20010;&#30913;&#30424;&#26609;&#38754;&#12290;&#19981;&#36807;&#29616;&#20195;&#30340;&#30913;&#30424;&#25216;&#26415;&#26159;&#22797;&#26434;&#22810;&#26679;&#30340;&#65292;
        &#25105;&#20204;&#24182;&#19981;&#33021;&#25511;&#21046;&#25991;&#20214;&#19982;&#30913;&#30424;&#26609;&#38754;&#30340;&#23545;&#24212;&#20851;&#31995;&#12290;&#23613;&#31649;&#22914;&#27492;&#65292;&#25105;&#20204;&#36890;&#36807;&#26368;&#22823;&#38480;&#24230;&#22320;&#38477;&#20302;&#25991;&#20214;&#23545;&#30913;&#30424;&#26609;&#38754;&#30340;&#21344;&#29992;&#65292;&#26469;&#38477;&#20302;&#30913;&#22836;&#30340;&#36816;&#21160;&#12290;
        &#36825;&#26159;&#22240;&#20026;&#22312;&#21516;&#19968;&#20010;&#26609;&#38754;&#30340;&#23384;&#21462;&#21482;&#38656;&#35201;&#30424;&#38754;&#30340;&#36716;&#21160;&#32780;&#19981;&#38656;&#35201;&#30913;&#22836;&#30340;&#36816;&#21160;&#12290;</p><p>&#24403;&#34987;&#21024;&#38500;&#30340;&#35760;&#24405;&#36234;&#26469;&#36234;&#22810;&#26102;&#65292;&#26377;&#30340;&#25991;&#20214;&#26368;&#32066;&#20250;&#21464;&#25104;&#19968;&#20010;&#27809;&#26377;&#26377;&#25928;&#35760;&#24405;&#30340;&#25991;&#20214;&#12290;&#36825;&#26679;&#30340;&#25991;&#20214;&#23601;&#21487;&#20197;&#22238;&#25910;&#20877;&#21033;&#29992;&#12290;HornetQ&#26377;
        &#19968;&#22871;&#22797;&#26434;&#30340;&#25991;&#20214;&#22238;&#25910;&#31639;&#27861;&#26469;&#21028;&#26029;&#19968;&#20010;&#26085;&#24535;&#25991;&#20214;&#26159;&#21542;&#21487;&#20197;&#34987;&#22238;&#25910;&#12290;</p><p>HornetQ&#36824;&#26377;&#19968;&#22871;&#25991;&#20214;&#25972;&#29702;&#30340;&#31639;&#27861;&#65292;&#23427;&#29992;&#26469;&#23558;&#26085;&#24535;&#25991;&#20214;&#20013;&#19981;&#29992;&#30340;&#31354;&#38553;&#31227;&#38500;&#20197;&#36798;&#21040;&#26356;&#39640;&#30340;&#23384;&#36142;&#25928;&#29575;&#12290;</p><p>&#36825;&#20010;&#26085;&#24535;&#31995;&#32479;&#20840;&#38754;&#25903;&#25345;&#20107;&#21153;&#21151;&#33021;&#12290;&#26681;&#25454;&#38656;&#35201;&#23427;&#21487;&#20197;&#25903;&#25345;&#26412;&#22320;&#20107;&#21153;&#25110;XA&#22411;&#20107;&#21153;&#12290;</p><p>&#26085;&#24535;&#31995;&#32479;&#30340;&#22823;&#37096;&#20998;&#26159;&#29992;Java&#23454;&#29616;&#30340;&#65292;&#20294;&#26159;HornetQ&#22312;&#20854;&#20013;&#23454;&#29616;&#20102;&#19968;&#23618;&#25277;&#35937;&#30340;&#25991;&#20214;&#31995;&#32479;&#65292;&#36825;&#26679;&#23601;&#20351;&#24471;&#20854;&#23427;&#30340;&#35821;&#35328;&#23454;&#29616;&#33021;
        &#26041;&#20415;&#22320;&#8220;&#25554;&#20837;&#8221;&#21040;&#26085;&#24535;&#27169;&#22359;&#20013;&#12290;&#23454;&#38469;&#19978;HornetQ&#33258;&#24102;&#26377;&#20004;&#31181;&#23454;&#29616;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>Java <a href="http://en.wikipedia.org/wiki/New_I/O" target="_top">NIO</a>&#12290;</p><p>&#31532;&#19968;&#31181;&#37319;&#29992;&#30340;&#26159;&#26631;&#20934;&#30340;Java NIO&#25509;&#21475;&#26469;&#36827;&#34892;&#25991;&#20214;&#30340;&#25805;&#20316;&#12290;&#23427;&#21487;&#20197;&#22312;&#20219;&#20309;&#23433;&#35013;&#26377;Java 1.6&#25110;&#20197;&#19978;&#30340;&#31995;&#32479;&#20013;&#36816;&#34892;&#12290;
                NIO&#30340;&#24615;&#33021;&#26159;&#24456;&#39640;&#30340;&#12290;</p></li><li><p><a name="aio-journal"></a>Linux &#24322;&#27493;IO &#65288;Asynchronous IO&#65289;</p><p>&#31532;&#20108;&#31181;&#26159;&#37319;&#29992;&#30340;Linux&#31995;&#32479;&#20013;&#30340;&#24322;&#27493;IO&#25216;&#26415;&#65288;AIO&#65289;&#12290;&#23427;&#21253;&#25324;&#20102;&#23569;&#37327;&#30340;&#24179;&#21488;&#30456;&#20851;&#30340;&#20195;&#30721;&#65288;native code)&#26469;
&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#35843;&#29992;AIO&#30340;&#25509;&#21475;&#12290;&#24403;&#25968;&#25454;&#34987;&#20445;&#23384;&#21040;&#30913;&#30424;&#19978;&#21518;&#65292;AIO&#20250;&#22238;&#35843;HornetQ&#36827;&#34892;&#36890;&#30693;&#12290;&#36825;&#26679;&#65292;HornetQ&#23601;&#36991;&#20813;&#20102;&#30913;&#30424;&#20889;
                &#30340;&#21516;&#27493;&#25805;&#20316;&#12290;</p><p>&#20351;&#29992;AIO&#36890;&#24120;&#21487;&#20197;&#26377;&#27604;NIO&#26356;&#39640;&#30340;&#24615;&#33021;&#12290;</p><p>&#37319;&#29992;AIO&#30340;&#26085;&#24535;&#21482;&#33021;&#22312;&#36816;&#34892; Linux kernel 2.6 &#25110;&#20197;&#19978;&#29256;&#26412;&#30340;&#20869;&#26680;&#30340;&#31995;&#32479;&#20013;&#25165;&#26377;&#12290;&#21478;&#22806;&#20320;&#38656;&#35201;&#23433;&#35013;libaio&#12290;
                &#26377;&#20851;&#22914;&#20309;&#23433;&#35013;libaio&#35831;&#21442;&#35265; <a href="persistence.html#installing-aio" title="15.5.&nbsp;&#23433;&#35013;AIO">Section&nbsp;15.5, &#8220;&#23433;&#35013;AIO&#8221;</a>&#12290;</p><p>&#21478;&#22806;&#35831;&#27880;&#24847;AIO&#21482;&#22312;&#20197;&#19979;&#25991;&#20214;&#31995;&#32479;&#19978;&#33021;&#27491;&#30830;&#24037;&#20316;&#65306;ext2, ext3, ext4, jfs, xfs&#12290;&#20854;&#20182;&#25991;&#20214;&#31995;&#32479;&#22914;NFS&#65292;&#34429;&#28982;
            AIO&#30475;&#19978;&#21435;&#21487;&#20197;&#24037;&#20316;&#65292;&#23454;&#38469;&#19978;&#26159;&#20197;&#36739;&#24930;&#30340;&#21516;&#27493;&#30340;&#26041;&#24335;&#22312;&#36816;&#34892;&#12290;&#25152;&#20197;&#19981;&#35201;&#22312;NFS&#19978;&#20351;&#29992;&#26085;&#24535;&#12290;</p><p>&#26377;&#20851;libaio&#30340;&#26356;&#22810;&#20171;&#32461;&#21442;&#35265; <a href="libaio.html" title="Chapter&nbsp;40.&nbsp;Libaio&#24179;&#21488;&#19987;&#26377;&#24211;">Chapter&nbsp;40, <i>Libaio&#24179;&#21488;&#19987;&#26377;&#24211;</i></a>&#12290;</p><p>libaio&#26159;Linux&#20869;&#26680;&#39033;&#30446;&#30340;&#19968;&#37096;&#20998;&#12290;</p></li></ul></div><p>&#26631;&#20934;&#30340;HornetQ&#26680;&#24515;&#26381;&#21153;&#22120;&#20351;&#29992;&#20102;&#20004;&#31181;&#26085;&#24535;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>&#32465;&#23450;&#26085;&#24535;</p><p>&#36825;&#20010;&#26085;&#24535;&#29992;&#26469;&#20445;&#23384;&#19982;&#32465;&#23450;&#26377;&#20851;&#30340;&#25968;&#25454;&#12290;&#20854;&#20013;&#21253;&#25324;&#22312;HornetQ&#19978;&#37096;&#32626;&#30340;&#38431;&#21015;&#21450;&#20854;&#23646;&#24615;&#65292;&#36824;&#26377;ID&#24207;&#21015;&#35745;&#25968;&#22120;&#12290; </p><p>&#32465;&#23450;&#26085;&#24535;&#26159;&#19968;&#20010;NIO&#22411;&#26085;&#24535;&#12290;&#19982;&#28040;&#24687;&#26085;&#24535;&#30456;&#27604;&#23427;&#30340;&#21585;&#21520;&#37327;&#26159;&#27604;&#36739;&#20302;&#30340;&#12290;</p></li><li><p>JMS&#26085;&#24535;</p><p>&#36825;&#20010;&#26085;&#24535;&#20445;&#23384;&#25152;&#26377;JMS&#30456;&#20851;&#30340;&#25968;&#25454;&#65292;&#21253;&#25324;JMS&#38431;&#21015;&#65292;&#35805;&#39064;&#21450;&#36830;&#25509;&#24037;&#21378;&#65292;&#20197;&#21450;&#23427;&#20204;&#30340;JNDI&#32465;&#23450;&#20449;&#24687;&#12290;</p><p>&#36890;&#36807;&#31649;&#29702;&#25509;&#21475;&#21019;&#24314;&#30340;JMS&#36164;&#28304;&#23558;&#34987;&#20445;&#23384;&#22312;&#36825;&#20010;&#26085;&#24535;&#20013;&#12290;&#20294;&#26159;&#36890;&#36807;&#37197;&#32622;&#25991;&#20214;&#37197;&#32622;&#30340;&#36164;&#28304;&#21017;&#19981;&#20445;&#23384;&#12290;&#21482;&#26377;&#20351;&#29992;JMS&#26102;JMS&#30340;&#26085;&#24535;
               &#25165;&#34987;&#21019;&#24314;&#12290;</p></li><li><p>&#28040;&#24687;&#26085;&#24535;</p><p>&#36825;&#20010;&#26085;&#24535;&#29992;&#26469;&#23384;&#36142;&#25152;&#26377;&#28040;&#24687;&#30456;&#20851;&#30340;&#25968;&#25454;&#65292;&#21253;&#25324;&#28040;&#24687;&#26412;&#36523;&#21644;&#37325;&#22797;ID&#32531;&#23384;&#12290;</p><p>&#40664;&#35748;&#24773;&#20917;&#19979;HornetQ&#24635;&#26159;&#20248;&#20808;&#20351;&#29992;AIO&#22411;&#26085;&#24535;&#12290;&#22914;&#26524;AIO&#22411;&#26085;&#24535;&#19981;&#21487;&#29992;&#65288;&#27604;&#22914;&#22312;&#38750;Linux&#24179;&#21488;&#19978;&#36816;&#34892;&#65292;&#25110;&#31995;&#32479;&#20869;&#26680;&#29256;&#26412;&#19981;&#21516;&#65289;
                &#23427;&#23558;&#33258;&#21160;&#20351;&#29992;NIO&#22411;&#26085;&#24535;&#12290;</p></li></ul></div><p>&#23545;&#20110;&#36229;&#22823;&#28040;&#24687;&#65292;Hornet&#23558;&#23427;&#20204;&#20445;&#23384;&#22312;&#28040;&#24687;&#26085;&#24535;&#20043;&#22806;&#30340;&#22320;&#26041;&#12290;&#35814;&#35265;<a href="large-messages.html" title="Chapter&nbsp;23.&nbsp;&#22823;&#28040;&#24687;">Chapter&nbsp;23, <i>&#22823;&#28040;&#24687;</i></a>.</p><p>HornetQ&#36824;&#21487;&#20197;&#22312;&#20869;&#23384;&#19981;&#22815;&#29992;&#26102;&#23558;&#28040;&#24687;&#26242;&#23384;&#21040;&#30913;&#30424;&#19978;&#12290;&#30456;&#20851;&#30340;&#37197;&#32622;&#21644;&#35828;&#26126;&#21442;&#35265;<a href="paging.html" title="Chapter&nbsp;24.&nbsp;&#20998;&#39029;&#36716;&#23384;">Chapter&nbsp;24, <i>&#20998;&#39029;&#36716;&#23384;</i></a>&#12290;</p><p>&#22914;&#26524;&#19981;&#38656;&#35201;&#25345;&#20037;&#21151;&#33021;&#65292;HornetQ&#36824;&#21487;&#20197;&#37197;&#32622;&#25104;&#38750;&#25345;&#20037;&#30340;&#28040;&#24687;&#31995;&#32479;&#12290;&#21442;&#35265;<a href="persistence.html#persistence.enabled" title="15.6.&nbsp;&#37197;&#32622;HornetQ&#19981;&#20351;&#29992;&#25345;&#20037;&#21270;">Section&nbsp;15.6, &#8220;&#37197;&#32622;HornetQ&#19981;&#20351;&#29992;&#25345;&#20037;&#21270;&#8221;</a>&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuring.bindings.journal"></a>15.1.&nbsp;&#37197;&#32622;&#32465;&#23450;&#26085;&#24535;</h2></div></div><div></div></div><p>&#32465;&#23450;&#26085;&#24535;&#30340;&#37197;&#32622;&#21442;&#25968;&#22312; <tt class="literal">hornetq-configuration.xml</tt>&#25991;&#20214;&#20013;&#12290;</p><div class="itemizedlist"><ul type="disc"><li><p><tt class="literal">bindings-directory</tt></p><p>&#36825;&#26159;&#32465;&#23450;&#26085;&#24535;&#30340;&#20301;&#32622;&#12290;&#40664;&#35748;&#20540;&#26159;<tt class="literal">data/bindings</tt>&#12290;</p></li><li><p><tt class="literal">create-bindings-dir</tt></p><p>&#22914;&#26524;&#35774;&#32622;&#20026;<tt class="literal">true</tt>&#65292;&#37027;&#20040;&#22312; <tt class="literal">bindings-directory</tt> &#25152;&#35774;&#23450;&#30340;&#20301;&#32622;&#19981;&#23384;&#22312;&#30340;&#24773;&#20917;&#19979;&#20250;&#33258;&#21160;&#21019;&#24314;&#23427;&#12290;&#40664;&#35748;&#20540;&#26159;<tt class="literal">true</tt>&#12290;</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuring.bindings.jms"></a>15.2.&nbsp;&#37197;&#32622;JMS&#26085;&#24535;</h2></div></div><div></div></div><p>JMS&#26085;&#24535;&#30340;&#37197;&#32622;&#19982;&#32465;&#23450;&#26085;&#24535;&#20849;&#29992;&#37197;&#32622;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuring.message.journal"></a>15.3.&nbsp;&#37197;&#32622;&#28040;&#24687;&#26085;&#24535;</h2></div></div><div></div></div><p>&#28040;&#24687;&#26085;&#24535;&#30340;&#37197;&#32622;&#22312;<tt class="literal">hornetq-configuration.xml&#25991;&#20214;&#20013;&#12290;</tt></p><div class="itemizedlist"><ul type="disc"><li><p><a name="configuring.message.journal.journal-directory"></a><tt class="literal">journal-directory</tt></p><p>&#36825;&#26159;&#28040;&#24687;&#26085;&#24535;&#25991;&#20214;&#25152;&#22312;&#30340;&#30446;&#24405;&#12290;&#40664;&#35748;&#20540;&#26159;
                        <tt class="literal">data/journal</tt>&#12290;</p><p>&#20026;&#20197;&#36798;&#21040;&#26368;&#20339;&#24615;&#33021;&#65292;&#25105;&#20204;&#24314;&#35758;&#23558;&#26085;&#24535;&#35774;&#23450;&#21040;&#23646;&#20110;&#23427;&#33258;&#24049;&#30340;&#29289;&#29702;&#21367;&#20013;&#20197;&#20943;&#23569;&#30913;&#22836;&#36816;&#21160;&#12290;&#22914;&#26524;&#26085;&#24535;&#30340;&#20301;&#32622;&#19982;
                    &#20854;&#23427;&#36827;&#31243;&#20849;&#29992;&#65288;&#22914;&#25968;&#25454;&#24211;&#65292;&#32465;&#23450;&#26085;&#24535;&#25110;&#20107;&#21153;&#30340;&#26085;&#24535;&#31561;&#65289;&#21017;&#30913;&#22836;&#30340;&#36816;&#21160;&#26174;&#28982;&#35201;&#22686;&#21152;&#24456;&#22810;&#12290;&#24615;&#33021;&#20063;&#23601;&#27809;&#26377;&#20445;&#35777;&#20102;&#12290;</p><p>&#22914;&#26524;&#28040;&#24687;&#26085;&#24535;&#26159;&#36142;&#23384;&#22312;SAN&#20013;&#65292;&#25105;&#20204;&#24314;&#35758;&#27599;&#20010;&#26085;&#24535;&#37117;&#25317;&#26377;&#33258;&#24049;&#30340;LUN&#65288;&#36923;&#36753;&#21333;&#20803;&#65289;&#12290;</p></li><li><p><a name="configuring.message.journal.create-journal-dir"></a><tt class="literal">create-journal-dir</tt></p><p>&#22914;&#26524;&#35774;&#20026;<tt class="literal">true</tt>&#65292;&#21017;&#24403;<tt class="literal">journal-directory</tt>&#25152;&#25351;&#23450;&#30340;&#26085;&#24535;&#30446;&#24405;&#19981;&#23384;&#22312;&#26102;&#65292;&#20250;&#33258;&#21160;&#21019;&#24314;&#23427;&#12290;&#40664;&#35748;&#20540;&#26159;<tt class="literal">true</tt>&#12290;</p></li><li><p><a name="configuring.message.journal.journal-type"></a><tt class="literal">journal-type</tt></p><p>&#26377;&#25928;&#20540;&#26159;<tt class="literal">NIO</tt> &#25110;&#32773; <tt class="literal">ASYNCIO</tt>&#12290;</p><p>Choosing <tt class="literal">NIO</tt> chooses the Java NIO journal. Choosing
                        <tt class="literal">AIO</tt> &#36873;&#25321;&#20316;&#29992;&#24322;&#27493;IO&#22411;&#26085;&#24535;&#12290;&#22914;&#26524;&#20320;&#30340;&#24179;&#21488;&#19981;&#26159;Linux&#25110;&#32773;&#20320;&#27809;&#26377;&#23433;&#35013;
                    libaio&#65292;HornetQ&#20250;&#33258;&#21160;&#26816;&#27979;&#21040;&#24182;&#20351;&#29992;<tt class="literal">NIO</tt>&#12290;</p></li><li><p><a name="configuring.message.journal.journal-sync-transactional"></a><tt class="literal">journal-sync-transactional</tt></p><p>&#22914;&#26524;&#35774;&#20026;true&#65292;HornetQ&#20250;&#20445;&#35777;&#22312;&#20107;&#21153;&#30340;&#36793;&#30028;&#25805;&#20316;&#26102;&#65288;commit, prepare&#21644;rollback&#65289;&#23558;&#20107;&#21153;&#25968;&#25454;
                    &#20889;&#21040;&#30913;&#30424;&#19978;&#12290;&#40664;&#35748;&#30340;&#20540;&#26159; <tt class="literal">true</tt>&#12290;</p></li><li><p><a name="configuring.message.journal.journal-sync-non-transactional"></a><tt class="literal">journal-sync-non-transactional</tt></p><p>&#22914;&#26524;&#35774;&#20026;true HornetQ&#23558;&#20445;&#35777;&#27599;&#27425;&#37117;&#23558;&#38750;&#20107;&#21153;&#24615;&#28040;&#24687;&#25968;&#25454;&#65288;&#21457;&#36865;&#21644;&#36890;&#30693;&#65289;&#20445;&#23384;&#21040;&#30913;&#30424;&#19978;&#12290;&#40664;&#35748;&#20540;&#26159; <tt class="literal">true</tt>&#12290;</p></li><li><p><a name="configuring.message.journal.journal-file-size"></a><tt class="literal">journal-file-size</tt></p><p>&#27599;&#20010;&#26085;&#24535;&#25991;&#20214;&#30340;&#22823;&#20110;&#12290;&#21333;&#20301;&#20026;&#23383;&#33410;&#12290;&#40664;&#35748;&#20540;&#26159; <tt class="literal">10485760</tt> bytes (10MiB)&#12290;</p></li><li><p><a name="configuring.message.journal.journal-min-files"></a><tt class="literal">journal-min-files</tt></p><p>&#26368;&#23569;&#26085;&#24535;&#25991;&#20214;&#25968;&#12290;&#24403;HornetQ&#21551;&#21160;&#26102;&#20250;&#21019;&#24314;&#36825;&#19968;&#25968;&#37327;&#30340;&#25991;&#20214;&#12290;</p><p>&#21019;&#24314;&#24182;&#21021;&#22987;&#21270;&#26085;&#24535;&#25991;&#20214;&#26159;&#19968;&#39033;&#36153;&#26102;&#30340;&#25805;&#20316;&#65292;&#36890;&#24120;&#19981;&#24076;&#26395;&#36825;&#20123;&#25805;&#20316;&#22312;&#26381;&#21153;&#36816;&#34892;&#26102;&#25191;&#34892;&#12290;&#39044;&#20808;&#21019;&#24314;&#24182;&#21021;&#22987;&#21270;&#36825;&#20123;
                    &#26085;&#24535;&#25991;&#20214;&#23558;&#20250;&#20351;HornetQ&#22312;&#24037;&#20316;&#26102;&#36991;&#20813;&#28010;&#36153;&#19981;&#24517;&#35201;&#30340;&#26102;&#38388;&#12290;</p><p>&#26681;&#25454;&#20320;&#30340;&#24212;&#29992;&#20013;&#38431;&#21015;&#20013;&#28040;&#24687;&#37327;&#30340;&#23454;&#38469;&#35201;&#27714;&#21487;&#20197;&#36866;&#24403;&#35843;&#33410;&#36825;&#19968;&#21442;&#25968;&#12290;</p></li><li><p><a name="configuring.message.journal.journal-max-io"></a><tt class="literal">journal-max-io</tt></p><p>&#20889;&#35831;&#27714;&#34987;&#25918;&#21040;&#19968;&#20010;&#38431;&#21015;&#20013;&#65292;&#28982;&#21518;&#20877;&#34987;&#21457;&#36865;&#21040;&#31995;&#32479;&#20013;&#25191;&#34892;&#12290;&#36825;&#20010;&#21442;&#25968;&#38480;&#21046;&#20102;&#22312;&#20219;&#19968;&#26102;&#38388;&#38431;&#21015;&#20013;&#21487;&#20197;&#23384;&#25918;&#30340;&#26368;&#22823;&#25968;&#37327;
                    &#30340;&#20889;&#35831;&#27714;&#12290;&#22914;&#26524;&#38431;&#21015;&#36798;&#21040;&#36825;&#20010;&#38480;&#21046;&#65292;&#20219;&#20309;&#26032;&#30340;&#20889;&#35831;&#27714;&#37117;&#23558;&#34987;&#38459;&#22622;&#65292;&#30452;&#21040;&#38431;&#21015;&#20013;&#26377;&#31354;&#20301;&#20026;&#27490;&#12290;</p><p>&#24403;&#20351;&#29992;NIO&#26102;&#65292;&#36825;&#20010;&#21442;&#25968;&#24517;&#39035;&#20026; <tt class="literal">1</tt>&#12290;</p><p>&#24403;&#20351;&#29992;AIO&#26102;&#65292;&#23427;&#30340;&#40664;&#35748;&#20540;&#26159;<tt class="literal">500</tt>&#12290;</p><p>&#31995;&#32479;&#26681;&#25454;&#19981;&#21516;&#31867;&#22411;&#30340;&#26085;&#24535;&#25552;&#20379;&#19981;&#21516;&#30340;&#40664;&#35748;&#20540;&#12290;(NIO &#20026; 1,  AIO &#20026; 500)&#12290;</p><p>&#22914;&#26524;&#26159;AIO&#65292;&#36825;&#20010;&#21442;&#25968;&#30340;&#19978;&#38480;&#19981;&#33021;&#36229;&#36807;&#25805;&#20316;&#31995;&#32479;&#30340;&#38480;&#21046;(/proc/sys/fs/aio-max-nr)&#65292;&#36825;&#20010;&#20540;&#36890;&#24120;&#20026;65536.</p></li><li><p><a name="configuring.message.journal.journal-buffer-timeout"></a><tt class="literal">journal-buffer-timeout</tt></p><p>&#26085;&#24535;&#27169;&#22359;&#20013;&#26377;&#19968;&#20010;&#20869;&#37096;&#32531;&#20914;&#12290;&#27599;&#27425;&#20889;&#30340;&#20869;&#23481;&#24182;&#19981;&#26159;&#37117;&#31435;&#21363;&#20889;&#21040;&#30913;&#30424;&#19978;&#65292;&#32780;&#26159;&#20808;&#25918;&#21040;&#36825;&#20010;&#20869;&#37096;&#32531;&#23384;&#20013;&#12290;&#24403;&#36825;&#20010;&#32531;&#23384;&#24050;&#28385;&#26102;&#65292;&#25110;
                    &#32773;&#36229;&#36807;&#20102;&#19968;&#23450;&#30340;&#26102;&#38388;&#65288;timeout&#65289;&#65292;&#25165;&#23558;&#32531;&#23384;&#30340;&#25968;&#25454;&#23384;&#21040;&#30828;&#30424;&#19978;&#12290;NIO&#21644;AIO&#37117;&#26377;&#36825;&#19968;&#29305;&#28857;&#12290;&#37319;&#29992;&#32531;&#23384;&#30340;&#26041;&#24335;&#21487;&#20197;&#24456;&#22909;&#22320;&#28385;&#36275;
                    &#22823;&#37327;&#24182;&#21457;&#20889;&#25968;&#25454;&#30340;&#38656;&#35201;&#12290;</p><p>&#36825;&#19968;&#21442;&#25968;&#35268;&#23450;&#20102;&#32531;&#23384;&#30340;&#22833;&#25928;&#26102;&#38388;&#65292;&#22914;&#26524;&#36807;&#20102;&#36825;&#20010;&#26102;&#38388;&#65292;&#21363;&#20351;&#32531;&#23384;&#36824;&#27809;&#26377;&#28385;&#65292;&#20063;&#23558;&#25968;&#25454;&#20889;&#20837;&#30913;&#30424;&#20013;&#12290;AIO&#30340;&#20889;&#20837;
                    &#33021;&#21147;&#36890;&#24120;&#35201;&#27604;NIO&#24378;&#12290;&#22240;&#27492;&#31995;&#32479;&#23545;&#20110;&#19981;&#21516;&#31867;&#22411;&#30340;&#26085;&#24535;&#26377;&#30528;&#19981;&#21516;&#30340;&#40664;&#35748;&#20540;&#12290;&#65288; NIO&#30340;&#40664;&#35748;&#20540;&#26159; 3333333 &#32435;&#31186;&#65292;&#21363;&#27599;&#31186;300&#27425;&#12290;
                    &#32780;AIO&#21017;&#26159;500000&#32435;&#31186;&#65292;&#21363;&#27599;&#31186;2000&#27425;&#12290;&#65289;</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>&#21152;&#22312;&#36825;&#20010;&#21442;&#25968;&#26377;&#21487;&#33021;&#20250;&#22686;&#21152;&#31995;&#32479;&#30340;&#21585;&#21520;&#37327;&#65292;&#20294;&#21487;&#33021;&#20250;&#38477;&#20302;&#31995;&#32479;&#30340;&#21709;&#24212;&#33021;&#21147;&#12290;&#36890;&#24120;&#24773;&#20917;&#19979;&#40664;&#35748;&#20540;&#24212;&#35813;&#26159;&#27604;&#36739;&#29702;&#24819;&#30340;&#25240;&#20013;&#36873;&#25321;&#12290;</p></div></li><li><p><a name="configuring.message.journal.journal-buffer-size"></a><tt class="literal">journal-buffer-size</tt></p><p>AIO&#30340;&#23450;&#26102;&#32531;&#20914;&#30340;&#22823;&#23567;&#65292;&#40664;&#35748;&#20540;&#20026;<tt class="literal">490KiB</tt>&#12290;</p></li><li><p><a name="configuring.message.journal.journal-compact-min-files"></a><tt class="literal">journal-compact-min-files</tt></p><p>&#36827;&#34892;&#25972;&#29702;&#21387;&#32553;&#26085;&#24535;&#25805;&#20316;&#30340;&#26368;&#23569;&#25991;&#20214;&#25968;&#12290;&#24403;&#26085;&#24535;&#25991;&#20214;&#23569;&#20110;&#36825;&#20010;&#25968;&#26102;&#65292;&#31995;&#32479;&#19981;&#20250;&#36827;&#34892;&#25991;&#20214;&#30340;&#25972;&#29702;&#21387;&#32553;&#12290;</p><p>&#40664;&#35748;&#20540;&#26159; <tt class="literal">10</tt>&#12290;</p></li><li><p><a name="configuring.message.journal.journal-compact-percentage"></a><tt class="literal">journal-compact-percentage</tt></p><p>&#24320;&#22987;&#25972;&#29702;&#21387;&#32553;&#30340;&#30028;&#38480;&#20540;&#12290;&#24403;&#26377;&#25928;&#25968;&#25454;&#30340;&#27604;&#20363;&#23569;&#20110;&#36825;&#20010;&#20540;&#26102;&#31995;&#32479;&#24320;&#22987;&#25972;&#29702;&#21387;&#32553;&#26085;&#24535;&#12290;&#27880;&#24847;&#26159;&#21542;&#36827;&#34892;&#21387;&#32553;&#36824;&#35201;
                    &#21463;&#21040;&#12289;<tt class="literal">journal-compact-min-files</tt>&#21442;&#25968;&#30340;&#25511;&#21046;&#12290;</p><p>&#36825;&#19968;&#21442;&#25968;&#30340;&#40664;&#35748;&#20540;&#26159; <tt class="literal">30</tt>&#12290;</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="disk-write-cache"></a>15.4.&nbsp;&#20851;&#20110;&#20851;&#38381;&#30913;&#30424;&#20889;&#32531;&#20914;&#30340;&#37325;&#35201;&#35828;&#26126;</h2></div></div><div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>&#22823;&#22810;&#25968;&#30913;&#30424;&#20135;&#21697;&#37117;&#26377;&#30828;&#20214;&#30340;&#20889;&#32531;&#20914;&#12290;&#20889;&#32531;&#20914;&#21487;&#20197;&#26126;&#26174;&#25552;&#39640;&#20889;&#30340;&#25928;&#29575;&#12290;</p><p>&#36825;&#26679;&#30340;&#20889;&#32531;&#20914;&#19982;&#35843;&#29992;fsync()&#36825;&#26679;&#30340;&#31995;&#32479;&#20989;&#25968;&#26080;&#20851;&#65292;&#20063;&#19982;&#22312;Java&#31243;&#24207;&#20013;&#36827;&#34892;&#30340;&#21516;&#27493;&#35843;&#29992;&#26080;&#20851;&#65281;</p><p>&#40664;&#35748;&#24773;&#20917;&#19979;&#35768;&#22810;&#30913;&#30424;&#30340;&#20889;&#32531;&#20914;&#26159;&#25171;&#24320;&#30340;&#12290;&#36825;&#26679;&#30340;&#24773;&#20917;&#19979;&#65292;&#21363;&#20351;&#20320;&#22312;&#31243;&#24207;&#20013;&#35843;&#29992;&#20102;&#21516;&#27493;&#25805;&#20316;&#20063;&#19981;&#33021;&#20445;&#35777;&#20320;&#30340;&#25968;&#25454;
                &#23601;&#30495;&#27491;&#20889;&#21040;&#30913;&#30424;&#20171;&#36136;&#20013;&#20102;&#12290;&#22240;&#27492;&#22914;&#26524;&#25925;&#38556;&#21457;&#29983;&#26102;&#65292;&#20851;&#38190;&#30340;&#25968;&#25454;&#26159;&#26377;&#21487;&#33021;&#20002;&#22833;&#30340;&#12290;</p><p>&#26377;&#20123;&#26114;&#36149;&#30340;&#30913;&#30424;&#37319;&#29992;&#38750;&#25381;&#21457;&#24615;&#30340;&#20171;&#36136;&#25110;&#26377;&#30005;&#28304;&#30340;&#32531;&#20914;&#26469;&#20445;&#35777;&#25925;&#38556;&#24773;&#20917;&#19979;&#19981;&#20002;&#22833;&#25968;&#25454;&#12290;&#20294;&#26159;&#20320;&#20173;&#38656;&#35201;&#23545;&#36825;&#20123;&#30828;&#30424;&#36827;&#34892;&#27979;&#35797;&#65281;</p><p>&#22914;&#26524;&#20320;&#30340;&#30913;&#30424;&#27809;&#26377;&#38750;&#25381;&#21457;&#24615;&#25110;&#26377;&#30005;&#28304;&#30340;&#32531;&#23384;&#65292;&#20063;&#19981;&#26159;&#26576;&#31181;&#20887;&#20313;&#30424;&#38453;&#65288;&#22914;RAID&#65289;&#12290;&#35201;&#24819;&#20445;&#35777;&#20851;&#38190;&#25968;&#25454;&#19981;&#20002;&#22833;&#65292;&#20320;&#38656;&#35201;
                &#20851;&#38381;&#30913;&#30424;&#30340;&#20889;&#32531;&#20914;&#12290;</p><p>&#38656;&#35201;&#30693;&#36947;&#30340;&#26159;&#20851;&#38381;&#30913;&#30424;&#30340;&#20889;&#32531;&#20914;&#20250;&#26174;&#33879;&#38477;&#20302;&#30913;&#30424;&#30340;&#24615;&#33021;&#12290;&#22914;&#26524;&#24179;&#26102;&#20320;&#22312;&#20351;&#29992;&#30913;&#30424;&#26102;&#37117;&#25171;&#24320;&#20889;&#32531;&#20914;&#65292;&#37027;&#20040;&#24403;&#20320;&#20026;&#20102;
                &#20445;&#25252;&#20320;&#30340;&#25968;&#25454;&#32780;&#20851;&#38381;&#23427;&#26102;&#65292;&#20320;&#21487;&#33021;&#24863;&#21040;&#20004;&#31181;&#24773;&#20917;&#19979;&#30340;&#26126;&#26174;&#24046;&#24322;&#12290;</p><p>Linux&#21487;&#20197;&#29992;<tt class="literal">hdparm</tt> (IDE&#30828;&#30424;) &#25110; <tt class="literal">sdparm</tt> &#25110;
                    <tt class="literal">sginfo</tt> (SDSI/SATA &#30828;&#30424;)&#24037;&#20855;&#26469;&#26597;&#30475;&#24182;&#20462;&#25913;&#30913;&#30424;&#30340;&#20889;&#32531;&#20914;&#12290;</p><p>&#22312;Windows&#24179;&#21488;&#19978;&#20320;&#21487;&#20197;&#21491;&#38190;&#28857;&#20987;&#30828;&#30424;&#22270;&#26631;&#65292;&#24182;&#36873;&#25321;&#8220;&#23646;&#24615;&#8221;&#33756;&#21333;&#39033;&#26469;&#25805;&#20316;&#12290;</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="installing-aio"></a>15.5.&nbsp;&#23433;&#35013;AIO</h2></div></div><div></div></div><p>Java NIO&#26085;&#24535;&#30340;&#24615;&#33021;&#26159;&#24456;&#22909;&#30340;&#12290;&#20294;&#26159;&#22914;&#26524;&#20320;&#26159;&#22312;Linux &#20869;&#26680;2.6&#29256;&#26412;&#20197;&#19978;&#30340;&#31995;&#32479;&#20013;&#36816;&#34892;HornetQ&#65292;&#25105;&#20204;&#24378;&#28872;&#24314;&#35758;
            &#20320;&#20351;&#29992; <tt class="literal">AIO</tt>&#26085;&#24535;&#65292;&#20197;&#33719;&#24471;&#26356;&#20339;&#30340;&#24615;&#33021;&#12290;</p><p>&#22312;&#26089;&#26399;&#30340;Linux&#29256;&#26412;&#20013;&#25110;&#20854;&#23427;&#25805;&#20316;&#31995;&#32479;&#20013;&#19981;&#21487;&#20197;&#20351;&#29992; AIO&#26085;&#24535;&#12290;</p><p>&#22914;&#26524;&#20320;&#30340;Linux&#20869;&#26680;&#26159;2.6&#29256;&#26412;&#25110;&#20197;&#19978;&#20294;&#27809;&#26377;&#23433;&#35013; <tt class="literal">libaio</tt>&#65292;&#25353;&#29031;&#19979;&#21015;&#27493;&#39588;&#21487;&#20197;&#24456;&#23481;&#26131;&#22320;&#23433;&#35013;&#23427;&#65306;</p><p>&#20351;&#29992; yum&#65292;(&#22914; Fedora &#25110; Red Hat Enterprise Linux):
            </p><pre class="programlisting">yum install libaio</pre><p>&#20351;&#29992; aptitude, (&#22914; Ubuntu &#25110; Debian):
            </p><pre class="programlisting">apt-get install libaio</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="persistence.enabled"></a>15.6.&nbsp;&#37197;&#32622;HornetQ&#19981;&#20351;&#29992;&#25345;&#20037;&#21270;</h2></div></div><div></div></div><p>&#22312;&#19968;&#20123;&#24773;&#20917;&#19979;&#28040;&#24687;&#31995;&#32479;&#24182;&#19981;&#38656;&#35201;&#25345;&#20037;&#21270;&#12290;&#36825;&#26102;&#21487;&#20197;&#37197;&#32622;HornetQ&#19981;&#20351;&#29992;&#25345;&#20037;&#23618;&#12290;&#21482;&#35201;&#23558;<tt class="literal">hornetq-configuration.xml</tt>&#25991;&#20214;&#20013;&#30340;<tt class="literal">persistence-enabled</tt>
              &#21442;&#25968;&#35774;&#20026;<tt class="literal">false</tt>&#21363;&#21487;&#12290; </p><p>&#27880;&#24847;&#22914;&#26524;&#20320;&#23558;&#35813;&#21442;&#25968;&#35774;&#20026; false&#26469;&#20851;&#38381;&#25345;&#20037;&#21270;&#65292;&#23601;&#24847;&#21619;&#30528;&#25152;&#26377;&#30340;&#32465;&#23450;&#25968;&#25454;&#12289;&#28040;&#24687;&#25968;&#25454;&#12289;&#36229;&#22823;&#28040;&#24687;&#25968;&#25454;&#12289;&#37325;&#22797;ID&#32531;&#20914;&#20197;&#21450;&#36716;&#31227;&#65288;paging&#65289;&#25968;&#25454;&#37117;&#23558;&#19981;&#20250;&#34987;&#25345;&#20037;&#12290;</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="filter-expressions.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="configuring-transports.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;14.&nbsp;&#36807;&#28388;&#22120;&#34920;&#36798;&#24335;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;16.&nbsp;&#20256;&#36755;&#23618;&#30340;&#37197;&#32622;</td></tr></table></div></body></html>