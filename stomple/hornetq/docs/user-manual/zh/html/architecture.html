<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;5.&nbsp;&#24635;&#20307;&#26550;&#26500;</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="HornetQ 2.1&#29992;&#25143;&#25163;&#20876;"><link rel="up" href="index.html" title="HornetQ 2.1&#29992;&#25143;&#25163;&#20876;"><link rel="previous" href="messaging-concepts.html" title="Chapter&nbsp;4.&nbsp;&#28040;&#24687;&#30340;&#30456;&#20851;&#27010;&#24565;"><link rel="next" href="using-server.html" title="Chapter&nbsp;6.&nbsp;&#20351;&#29992;HornetQ&#26381;&#21153;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;5.&nbsp;&#24635;&#20307;&#26550;&#26500;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="messaging-concepts.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="using-server.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="architecture"></a>Chapter&nbsp;5.&nbsp;&#24635;&#20307;&#26550;&#26500;</h2></div></div><div></div></div><p>&#26412;&#31456;&#23545;HornetQ&#30340;&#24635;&#20307;&#25216;&#26415;&#26550;&#26500;&#36827;&#34892;&#20102;&#27010;&#25324;&#25551;&#36848;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e477"></a>5.1.&nbsp;&#26680;&#24515;&#26550;&#26500;</h2></div></div><div></div></div><p>HornetQ&#30340;&#26680;&#24515;&#26159;&#30001;&#19968;&#32452;&#31616;&#21333;Java&#23545;&#35937;&#65288;POJO&#65289;&#26500;&#25104;&#30340;&#12290;&#21516;&#26102;&#22312;&#35774;&#35745;HornetQ&#26102;&#23558;&#23545;&#22806;&#37096;jar&#21253;&#30340;&#20381;&#36182;&#38477;&#21040;&#26368;&#20302;&#38480;&#24230;&#12290;
              &#23454;&#38469;&#19978;HornetQ&#30340;&#26680;&#24515;&#37096;&#20998;&#21482;&#26377;&#19968;&#20010;&#22806;&#37096;&#20381;&#36182;&#65292;&#23601;&#26159;netty.jar&#12290;HornetQ&#20351;&#29992;&#20102;&#20854;&#20013;&#30340;&#29992;&#20110;&#32531;&#20914;&#30340;&#19968;&#20123;&#31867;&#12290;
              &#25105;&#20204;&#30456;&#20449;&#36825;&#26679;&#30340;&#29702;&#24565;&#24212;&#35813;&#21463;&#21040;&#29992;&#25143;&#30340;&#27426;&#36814;&#12290;</p><p>&#30001;&#20110;&#20381;&#36182;&#24615;&#24456;&#23567;&#65292;HornetQ&#21487;&#20197;&#38750;&#24120;&#23481;&#26131;&#22320;&#23884;&#20837;&#21040;&#20854;&#23427;&#24212;&#29992;&#20013;&#65292;&#25110;&#32773;&#21152;&#20837;&#21040;&#19968;&#20123;&#20381;&#36182;&#27880;&#20837;&#24335;&#30340;&#26694;&#26550;&#20013;&#65292;
              &#22914;JBoss Microcontainer&#65292;Spring&#25110;Google Guice&#12290;</p><p>&#27599;&#20010;HornetQ&#26381;&#21153;&#22120;&#37117;&#26377;&#33258;&#24049;&#30340;&#36229;&#39640;&#24615;&#33021;&#30340;&#25345;&#20037;&#26085;&#24535;&#65288;journal&#65289;&#29992;&#20110;&#28040;&#24687;&#21644;&#20854;&#23427;&#20449;&#24687;&#30340;&#25345;&#20037;&#21270;&#12290;</p><p>&#37319;&#29992;&#36825;&#31181;&#29420;&#29305;&#30340;&#39640;&#25928;&#26085;&#24535;&#35201;&#27604;&#37319;&#29992;&#26222;&#36890;&#25968;&#25454;&#24211;&#20316;&#20026;&#25345;&#20037;&#23618;&#30340;&#31995;&#32479;&#25317;&#26377;&#26356;&#39640;&#30340;&#24615;&#33021;&#12290;</p><p>&#36890;&#24120;&#24773;&#20917;&#19979;&#20998;&#24067;&#22312;&#19981;&#21516;&#29289;&#29702;&#26426;&#22120;&#19978;&#30340;&#23458;&#25143;&#31471;&#21516;&#26102;&#35775;&#38382;HornetQ&#26381;&#21153;&#22120;&#12290;&#30446;&#21069;HornetQ&#25552;&#20379;&#20102;&#20004;&#22871;API&#20379;&#23458;&#25143;&#31471;&#20351;&#29992;&#65306;</p><p>
            </p><div class="orderedlist"><ol type="1"><li><p>&#26680;&#24515;API&#12290;&#36825;&#26159;&#19968;&#32452;&#26222;&#36890;&#30340;Java&#25509;&#21475;&#65292;&#29992;&#23427;&#21487;&#20197;&#35775;&#38382;HornetQ&#30340;&#20840;&#37096;&#21151;&#33021;&#12290;</p></li><li><p>JMS&#23458;&#25143;&#31471;API&#12290;&#36825;&#26159;&#26631;&#20934;&#30340;JMS API&#12290;</p></li></ol></div><p>
        </p><p>&#23454;&#38469;&#19978;JMS API&#26159;&#22312;&#26680;&#24515;API&#30340;&#22806;&#37096;&#21152;&#19978;&#19968;&#23618;&#31616;&#21333;&#30340;&#23553;&#35013;&#12290;</p><p>&#22312;HornetQ&#20869;&#26680;&#26159;&#27809;&#26377;JMS&#30340;&#65292;&#36825;&#26679;&#35774;&#35745;&#30340;&#30446;&#30340;&#26159;&#20026;&#20102;&#25903;&#25345;&#22810;&#20010;&#21327;&#35758;&#12290;</p><p>&#24403;&#23458;&#25143;&#31471;&#36890;&#36807;JMS&#25509;&#21475;&#35775;&#38382;HornetQ&#26102;&#65292;&#25152;&#26377;JMS&#30340;&#25805;&#20316;&#37117;&#34987;&#36716;&#25442;&#25104;&#30456;&#24212;&#30340;&#26680;&#24515;API&#65292;&#28982;&#21518;&#23558;&#35831;&#27714;&#20197;HornetQ&#26684;&#24335;&#21457;&#21521;&#26381;&#21153;&#22120;&#12290;</p><p>HornetQ&#26381;&#21153;&#22120;&#21482;&#25509;&#25910;&#26680;&#24515;API&#30340;&#35775;&#38382;&#12290;</p><p>&#22270;3.1&#25551;&#36848;&#20102;&#36825;&#20123;&#25805;&#20316;&#12290;</p><p>
            </p><div align="center"><img src="images/architecture1.jpg" align="middle"></div><p>
        </p><p>&#22312;&#22270;3.1&#20013;&#31034;&#20986;&#20102;&#20004;&#20010;&#29992;&#25143;&#35775;&#38382;HornetQ&#26381;&#21153;&#22120;&#12290;&#29992;&#25143;1&#20351;&#29992;JMS API&#65292;&#29992;&#25143;2&#20351;&#29992;&#30340;&#26159;&#26680;&#24515;API&#12290;</p><p>&#22270;&#20013;&#28165;&#26970;&#30340;&#23637;&#31034;&#20986;&#20102;JMS&#26159;&#22914;&#20309;&#36890;&#36807;&#23553;&#35013;&#65288;facade&#65289;&#36716;&#21270;&#20026;&#26680;&#24515;API&#30340;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e518"></a>5.2.&nbsp;&#23558;HornetQ&#23884;&#20837;&#21040;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;</h2></div></div><div></div></div><p>&#22914;&#26524;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20869;&#37096;&#38656;&#35201;&#28040;&#24687;&#26381;&#21153;&#65292;&#20294;&#21516;&#26102;&#20320;&#21448;&#19981;&#24819;&#23558;&#28040;&#24687;&#26381;&#21153;&#26292;&#38706;&#20026;&#21333;&#29420;&#30340;HornetQ&#26381;&#21153;&#22120;&#65292;&#20320;&#21487;&#20197;&#22312;&#24212;&#29992;&#20013;&#30452;&#25509;&#23558;HornetQ&#23454;&#20363;&#21270;&#12290;</p><p>&#26377;&#20851;&#23884;&#20837;&#24335;HornetQ&#30340;&#35814;&#32454;&#20449;&#24687;&#35831;&#21442;&#38405; <a href="embedding-hornetq.html" title="Chapter&nbsp;43.&nbsp;&#23884;&#20837;&#24335;HornetQ">Chapter&nbsp;43, <i>&#23884;&#20837;&#24335;HornetQ</i></a>&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e527"></a>5.3.&nbsp;&#23558;HornetQ&#19982;JEE&#24212;&#29992;&#26381;&#21153;&#22120;&#38598;&#25104;</h2></div></div><div></div></div><p>HornetQ&#25552;&#20379;&#20102;&#26631;&#20934;&#30340;JCA&#36866;&#37197;&#22120;&#65292;&#21033;&#29992;&#23427;&#21487;&#20197;&#23558;HornetQ&#36731;&#26494;&#22320;&#38598;&#25104;&#21040;&#20219;&#20309;&#19968;&#20010;&#31526;&#21512;JEE&#35268;&#33539;&#30340;&#24212;&#29992;&#26381;&#21153;&#22120;&#25110;servlet&#23481;&#22120;&#20013;&#12290;</p><p>JEE&#24212;&#29992;&#26381;&#21153;&#21697;&#25552;&#20379;&#20102;&#28040;&#24687;Bean&#65288;MDB&#65289;&#29992;&#20110;&#22788;&#29702;&#26469;&#33258;&#22806;&#37096;&#30340;&#28040;&#24687;&#65292;&#27604;&#22914;&#26469;&#33258;JMS&#31995;&#32479;&#25110;&#37038;&#20214;&#31995;&#32479;&#30340;&#28040;&#24687;&#12290;</p><p>&#26368;&#24120;&#35265;&#30340;&#24212;&#29992;&#24212;&#35813;&#26159;&#29992;MDB&#26469;&#25509;&#25910;&#26469;&#33258;JMS&#31995;&#32479;&#20013;&#30340;&#28040;&#24687;&#20102;&#12290;&#22312;JEE&#35268;&#33539;&#20013;&#35268;&#23450;&#20102;JEE&#24212;&#29992;&#26381;&#21153;&#22120;&#20351;&#29992;JCA adaptor&#19982;JMS&#28040;&#24687;&#31995;&#32479;&#38598;&#25104;&#65292;
              MDB&#36890;&#36807;&#36825;&#20010;adaptor&#26469;&#25509;&#25910;&#28040;&#24687;&#12290;</p><p>JCA adaptor&#19981;&#20165;&#21487;&#20197;&#29992;&#26469;&#25509;&#25910;&#28040;&#24687;&#65292;&#36824;&#21487;&#20197;&#29992;&#26469;&#20174;EJB&#25110;servlet&#20013;&#21521;&#22806;&#37096;&#30340;JMS&#21457;&#36865;&#28040;&#24687;&#12290;&#22312;JEE&#24212;&#29992;&#26381;&#21153;&#22120;&#20013;&#24212;&#35813;&#29992;JCA adaptor&#19982;JMS&#31995;&#32479;&#36827;&#34892;&#20132;&#20114;&#12290;
              &#23454;&#38469;&#19978;JEE&#35268;&#33539;&#20013;&#19981;&#20801;&#35768;&#22312;JEE&#26381;&#21153;&#22120;&#20013;&#19981;&#36890;&#36807;JCA&#32780;&#30452;&#25509;&#35775;&#38382;JMS&#31995;&#32479;&#12290;</p><p>&#22312;EJB&#20013;&#20351;&#29992;&#28040;&#24687;&#24448;&#24448;&#38656;&#35201;&#36830;&#25509;&#27744;&#25110;&#20132;&#26131;&#65292;&#32780;JCA&#21487;&#20197;&#25552;&#20379;&#36825;&#26041;&#38754;&#30340;&#26381;&#21153;&#65292;&#26080;&#38656;&#39069;&#22806;&#30340;&#24320;&#21457;&#20219;&#21153;&#12290;&#24403;&#28982;&#30452;&#25509;&#35775;&#38382;JMS&#31995;&#32479;&#26159;&#21487;&#33021;&#30340;&#65292;
              &#20294;&#26159;&#20320;&#23558;&#19981;&#33021;&#21033;&#29992;JCA&#25152;&#25552;&#20379;&#30340;&#36825;&#20123;&#26377;&#29992;&#30340;&#21151;&#33021;&#65292;&#22240;&#27492;&#25105;&#20204;&#19981;&#24314;&#35758;&#20351;&#29992;&#30452;&#25509;&#35775;&#38382;&#30340;&#26041;&#24335;&#12290;</p><p>&#22270;3.2&#32473;&#20986;&#20102;HornetQ&#36890;&#36807;JCA adaptor&#19982;JEE&#24212;&#29992;&#26381;&#21153;&#22120;&#38598;&#25104;&#30340;&#31034;&#24847;&#22270;&#12290;&#22270;&#20013;&#21487;&#20197;&#30475;&#20986;&#25152;&#26377;&#30340;&#20132;&#20114;&#37117;&#36890;&#36807;JCA adaptor&#12290;</p><p>&#22270;&#20013;&#24102;&#26377;&#31105;&#27490;&#31526;&#21495;&#30340;&#31661;&#22836;&#34920;&#26126;&#30340;&#26159;&#20174;EJB&#20250;&#35805;Bean&#30452;&#25509;&#35775;&#38382;HornetQ&#30340;&#24773;&#20917;&#12290;&#30001;&#20110;&#19981;&#36890;&#36807;JCA&#65292;&#36825;&#31181;&#26041;&#27861;&#24448;&#24448;&#36896;&#25104;&#27599;&#27425;EJB&#35775;&#38382;HornetQ&#37117;&#35201;&#26032;&#24314;&#19968;&#20010;&#36830;&#25509;&#21644;&#20250;&#35805;&#65292;
              &#20351;&#25928;&#29575;&#22823;&#38477;&#20302;&#12290;&#36825;&#34987;&#35270;&#20026;&#21453;&#35774;&#35745;&#27169;&#24335;&#65288;anti-pattern&#65289;&#12290;</p><p>
            </p><div><img src="images/architecture2.jpg"></div><p>
        </p><p><a href="appserver-integration.html" title="Chapter&nbsp;32.&nbsp;Java EE&#21644;&#24212;&#29992;&#26381;&#21153;&#22120;&#30340;&#38598;&#25104;">Chapter&nbsp;32, <i>Java EE&#21644;&#24212;&#29992;&#26381;&#21153;&#22120;&#30340;&#38598;&#25104;</i></a>&#23545;&#22914;&#20309;&#20351;&#29992;JCA&#32473;&#20986;&#20102;&#26356;&#21152;&#35814;&#32454;&#30340;&#25551;&#36848;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e551"></a>5.4.&nbsp;HornetQ&#20316;&#20026;&#29420;&#31435;&#30340;&#26381;&#21153;&#65288;standalone&#65289;</h2></div></div><div></div></div><p>HornetQ&#21487;&#20197;&#37096;&#32626;&#25104;&#20026;&#29420;&#31435;&#30340;&#26381;&#21153;&#22120;&#12290;&#23427;&#21487;&#36816;&#34892;&#20110;&#20219;&#20309;JEE&#24212;&#29992;&#26381;&#21153;&#22120;&#20043;&#22806;&#65292;&#20316;&#20026;&#19968;&#20010;&#29420;&#31435;&#30340;&#26381;&#21153;&#36816;&#34892;&#12290;
              &#20316;&#20026;&#29420;&#31435;&#26381;&#21153;&#22120;&#36816;&#34892;&#26102;&#65292;HornetQ&#28040;&#24687;&#26381;&#21153;&#22120;&#21253;&#25324;&#19968;&#20010;&#26680;&#24515;&#26381;&#21153;&#22120;&#65292;&#19968;&#20010;JMS&#26381;&#21153;&#20197;&#21450;&#19968;&#20010;JNDI&#26381;&#21153;&#12290;</p><p>JMS&#26381;&#21153;&#29992;&#26469;&#37096;&#32626;&#26381;&#21153;&#22120;&#31471;<tt class="literal">hornetq-jms.xml</tt>&#37197;&#32622;&#25991;&#20214;&#20013;&#30340;JMS Queue&#65292;Topic&#21644;ConnectionFactory&#23454;&#20363;&#12290;
              &#27492;&#22806;&#23427;&#36824;&#25552;&#20379;&#19968;&#32452;&#31616;&#21333;&#30340;&#31649;&#29702;&#25509;&#21475;&#65292;&#36890;&#36807;&#36825;&#20123;&#25509;&#21475;&#21487;&#20197;&#21019;&#24314;&#12289;&#28040;&#27585;&#65288;destroy&#65289;Queue&#65292;Topic&#21644;ConnectionFactory&#23454;&#20363;&#12290;
              &#29992;&#20110;&#21487;&#20197;&#36890;&#36807;JMX&#25110;&#36830;&#25509;&#20351;&#29992;&#36825;&#20123;&#25509;&#21475;&#12290;JMS&#26381;&#21153;&#26159;&#21333;&#29420;&#30340;&#26381;&#21153;&#65292;&#23427;&#19981;&#26159;HornetQ&#26680;&#24515;&#26381;&#21153;&#12290;HornetQ&#30340;&#26680;&#24515;&#19981;&#21253;&#21547;JMS&#30456;&#20851;&#30340;&#26381;&#21153;&#12290;
              &#22914;&#26524;&#20320;&#19981;&#38656;&#35201;&#36890;&#36807;&#26381;&#21153;&#22120;&#31471;&#30340;xml&#37197;&#32622;&#25991;&#20214;&#37096;&#32626;&#20219;&#20309;JMS&#23545;&#35937;&#65292;&#20063;&#19981;&#38656;&#35201;JMS&#30340;&#31649;&#29702;&#25509;&#21475;&#65292;&#20320;&#21487;&#20197;&#36873;&#25321;&#19981;&#21551;&#21160;&#35813;&#26381;&#21153;&#12290;</p><p>&#21551;&#21160;JNDI&#26381;&#21153;&#30340;&#30446;&#30340;&#26159;&#22240;&#20026;JMS&#38656;&#35201;&#36890;&#36807;JNDI&#26469;&#33719;&#24471;Queue&#65292;Topic&#20197;&#21450;ConnectionFactory&#12290;&#22914;&#26524;&#19981;&#38656;&#35201;&#65292;&#20063;&#21487;&#20197;&#36873;&#25321;&#19981;&#21551;&#21160;&#35813;&#26381;&#21153;&#12290;</p><p>HornetQ&#20801;&#35768;&#22312;&#23458;&#25143;&#31471;&#31243;&#24207;&#20013;&#36890;&#36807;&#32534;&#31243;&#26469;&#30452;&#25509;&#21019;&#24314;&#21508;&#31181;JMS&#23545;&#35937;&#21644;&#26680;&#24515;&#23545;&#35937;&#26469;&#20195;&#26367;JNDI&#26597;&#25214;&#65292;&#25152;&#20197;JNDI&#19981;&#26159;&#24517;&#38656;&#30340;&#12290;
              HornetQ&#37319;&#29992;JBoss Microcontainer&#26469;&#24341;&#23548;&#24182;&#23454;&#20363;&#21270;&#26381;&#21153;&#65292;&#24182;&#20445;&#35777;&#27169;&#22359;&#20043;&#38388;&#30340;&#20381;&#36182;&#20851;&#31995;&#12290;JBoss Microcontainer&#26159;&#19968;&#20010;&#36731;&#37327;&#32423;&#30340;POJO&#24341;&#23548;&#22120;&#65288;bootstrapper&#65289;&#12290;</p><p>&#22270;3.3&#32473;&#20986;&#20102;HornetQ&#29420;&#31435;&#26381;&#21153;&#22120;&#30340;&#26550;&#26500;&#12290;</p><p>
            </p><div><img src="images/architecture3.jpg"></div><p>
        </p><p>&#30456;&#20851;&#37197;&#32622;&#30340;&#30456;&#20851;&#20449;&#24687;&#21487;&#20197;&#22312;&#31532;<a href="configuration-index.html#server.configuration" title="47.1.&nbsp;&#26381;&#21153;&#22120;&#37197;&#32622;">Section&nbsp;47.1, &#8220;&#26381;&#21153;&#22120;&#37197;&#32622;&#8221;</a>&#25214;&#21040;&#12290;$ </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="messaging-concepts.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="using-server.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;4.&nbsp;&#28040;&#24687;&#30340;&#30456;&#20851;&#27010;&#24565;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;6.&nbsp;&#20351;&#29992;HornetQ&#26381;&#21153;</td></tr></table></div></body></html>