<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;7.&nbsp;&#20351;&#29992;JMS</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="HornetQ 2.1&#29992;&#25143;&#25163;&#20876;"><link rel="up" href="index.html" title="HornetQ 2.1&#29992;&#25143;&#25163;&#20876;"><link rel="previous" href="using-server.html" title="Chapter&nbsp;6.&nbsp;&#20351;&#29992;HornetQ&#26381;&#21153;"><link rel="next" href="using-core.html" title="Chapter&nbsp;8.&nbsp;&#20351;&#29992;HornetQ&#20869;&#26680;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;7.&nbsp;&#20351;&#29992;JMS</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="using-server.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="using-core.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="using-jms"></a>Chapter&nbsp;7.&nbsp;&#20351;&#29992;JMS</h2></div></div><div></div></div><p>&#24456;&#22810;&#29992;&#25143;&#21916;&#27426;&#20351;JMS&#65292;&#22240;&#27492;HornetQ&#25552;&#20379;&#20102;JMS&#26381;&#21153;&#12290;</p><p>JMS&#26159;&#19968;&#20010;&#26222;&#36941;&#20351;&#29992;API&#26631;&#20934;&#65292;&#32477;&#22823;&#22810;&#25968;&#30340;&#28040;&#24687;&#31995;&#32479;&#37117;&#25552;&#20379;JMS&#25509;&#21475;&#12290;&#22914;&#26524;&#20320;&#23545;JMS&#36824;&#19981;&#29087;&#24713;&#65292;&#24314;&#35758;&#20320;&#20808;&#21442;&#32771;&#19968;&#19979;
          Sun&#30340;<a href="http://java.sun.com/products/jms/tutorial/1_3_1-fcs/doc/jms_tutorialTOC.html" target="_top">
            JMS &#25945;&#31243;</a>&#12290;</p><p>HornetQ&#36824;&#25552;&#20379;&#20102;&#35768;&#22810;&#30340;JMS&#30340;&#31034;&#20363;&#31243;&#24207;&#65288;examples&#65289;&#12290;&#27604;&#22914;&#31616;&#21333;&#30340;JMS Queue&#21644;Topic&#30340;&#31034;&#20363;&#65292;&#23601;&#24456;&#36866;&#21512;&#21021;&#23398;&#32773;&#20570;&#20026;&#20102;
          &#35299;HornetQ JMS&#30340;&#36215;&#28857;&#12290;<a href="examples.html" title="Chapter&nbsp;11.&nbsp;&#20363;&#23376;">Chapter&nbsp;11, <i>&#20363;&#23376;</i></a>&#23545;&#36825;&#20123;&#31034;&#20363;&#20316;&#20102;&#35814;&#32454;&#30340;&#35828;&#26126;&#12290;</p><p>&#19979;&#38754;&#25105;&#20204;&#23558;&#24102;&#39046;&#35835;&#32773;&#19968;&#27493;&#27493;&#22320;&#37197;&#32622;HornetQ&#30340;JMS&#26381;&#21153;&#65292;&#24182;&#21019;&#24314;&#19968;&#20010;&#31616;&#21333;&#30340;JMS&#31243;&#24207;&#12290;&#25105;&#20204;&#36824;&#23558;&#23637;&#31034;&#22914;&#20309;&#22312;&#27809;&#26377;JNDI&#30340;&#24773;&#20917;&#19979;
          &#26469;&#20351;&#29992;HornetQ&#20013;&#30340;JMS&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e966"></a>7.1.&nbsp;&#19968;&#20010;&#31616;&#21333;&#30340;&#35746;&#36141;&#31995;&#32479;</h2></div></div><div></div></div><p>&#26412;&#31456;&#25105;&#20204;&#23558;&#29992;&#19968;&#20010;&#31616;&#21333;&#30340;&#35746;&#36141;&#31995;&#32479;&#20570;&#20026;&#19968;&#20010;&#20363;&#23376;&#12290;&#23613;&#31649;&#23427;&#21313;&#20998;&#31616;&#21333;&#65292;&#20294;&#26159;&#23427;&#33021;&#22815;&#24456;&#22909;&#22320;&#21521;&#22823;&#23478;&#23637;&#31034;JMS&#30340;&#35774;&#32622;&#21644;&#20351;&#29992;&#12290;</p><p>&#26412;&#20363;&#20013;&#26377;&#19968;&#20010;&#21517;&#20026; <tt class="literal">OrderQueue</tt>JMS&#38431;&#21015;&#65292;&#36824;&#23558;&#26377;&#19968;&#20010; <tt class="literal">MessageProducer</tt> 
              &#29992;&#26469;&#21521;&#38431;&#21015;&#21457;&#36865;&#35746;&#36141;&#28040;&#24687;&#12290;&#21457;&#36865;&#21040;&#38431;&#21015;&#30340;&#28040;&#24687;&#30001;&#19968;&#20010; <tt class="literal">MessageConsumer</tt> &#26469;&#25509;&#25910;&#12290;</p><p>&#25105;&#20204;&#25152;&#29992;&#30340;&#38431;&#21015;&#26159;<tt class="literal">&#25345;&#20037;&#65288;durable&#65289;</tt>&#30340;&#38431;&#21015;&#65292;&#20063;&#23601;&#26159;&#35828;&#36825;&#20010;&#38431;&#21015;&#19981;&#21463;&#26381;&#21153;&#22120;&#25925;&#38556;&#30340;&#24433;&#21709;&#12290;&#24403;&#26381;&#21153;&#22120;
              &#21457;&#29983;&#25925;&#38556;&#37325;&#26032;&#21551;&#21160;&#21518;&#65292;&#36825;&#20010;&#38431;&#21015;&#20173;&#28982;&#23384;&#22312;&#12290;&#25105;&#20204;&#38656;&#35201;&#25226;&#36825;&#20010;&#38431;&#21015;&#20107;&#20808;&#37096;&#32626;&#22909;&#12290;&#21150;&#27861;&#23601;&#26159;&#23558;&#38431;&#21015;&#20889;&#21040;JMS&#30340;&#37197;&#32622;&#25991;&#20214;&#20013;&#12290;&#24403;&#26381;&#21153;&#21551;&#21160;
              &#26102;&#23558;&#37197;&#32622;&#25991;&#20214;&#20013;&#30340;&#38431;&#21015;&#33258;&#21160;&#37096;&#32626;&#22909;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="using-jms.server.configuration"></a>7.2.&nbsp;JMS&#26381;&#21153;&#30340;&#37197;&#32622;</h2></div></div><div></div></div><p><tt class="literal">hornetq-jms.xml</tt>&#25991;&#20214;&#21253;&#21547;&#20102;&#38656;&#35201;&#21019;&#24314;&#19982;&#37096;&#32626;&#30340;JMS Queue&#65292;Topic&#21644;ConnectionFactory
            &#30340;&#23454;&#20363;&#12290;&#35813;&#25991;&#20214;&#24517;&#39035;&#35201;&#25351;&#23450;&#22312;classpath&#20013;&#12290;&#20174;&#36825;&#20010;&#25991;&#20214;&#20013;&#37096;&#32626;&#22909;&#30340;&#23545;&#35937;&#37117;&#21487;&#20197;&#29992;JNDI&#26469;&#25214;&#21040;&#12290;</p><p>JMS&#23458;&#25143;&#31471;&#21487;&#20197;&#21033;&#29992;JMS ConnectionFactory&#23545;&#35937;&#26469;&#21019;&#24314;&#19982;&#26381;&#21153;&#22120;&#30340;&#36830;&#25509;&#12290;ConnectionFactory&#20013;&#26377;&#20851;&#20110;&#26381;&#21153;&#22120;&#22320;&#22336;&#30340;
              &#20449;&#24687;&#20197;&#21450;&#21508;&#31181;&#21442;&#25968;&#12290;&#36890;&#24120;&#20351;&#29992;&#36825;&#20123;&#21442;&#25968;&#30340;&#40664;&#35748;&#20540;&#21363;&#21487;&#12290;</p><p>&#36825;&#37324;&#25105;&#20204;&#23558;&#35201;&#22312;&#26381;&#21153;&#22120;&#31471;&#37096;&#32626;&#19968;&#20010;JMS&#38431;&#21015;&#21644;&#19968;&#20010;JMS ConnectionFactory &#65288;&#36830;&#25509;&#24037;&#21378;&#65289;&#12290;&#24403;&#28982;&#23436;&#20840;&#21487;&#20197;&#37096;&#32626;&#22810;&#20010;JMS&#23545;&#35937;&#12290;
              &#19979;&#38754;&#32473;&#20986;&#20102;&#20855;&#20307;&#30340;&#37197;&#32622;&#20869;&#23481;&#65306;</p><pre class="programlisting">
&lt;configuration xmlns="urn:hornetq" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="urn:hornetq ../schemas/hornetq-jms.xsd "&gt;
    
    &lt;connection-factory name="ConnectionFactory"&gt;
        &lt;connectors&gt;
           &lt;connector-ref connector-name="netty"/&gt;
        &lt;/connectors&gt;
        &lt;entries&gt;
            &lt;entry name="ConnectionFactory"/&gt;           
        &lt;/entries&gt;
    &lt;/connection-factory&gt;
    
    &lt;queue name="OrderQueue"&gt;
        &lt;entry name="queues/OrderQueue"/&gt;
    &lt;/queue&gt;
    
&lt;/configuration&gt; 
        </pre><p>&#22312;&#26412;&#25991;&#20214;&#20013;&#25105;&#20204;&#37096;&#32626;&#20102;&#19968;&#20010;&#21517;&#20026; <tt class="literal">ConnectionFactory</tt> &#30340;&#19968;&#20010;&#36830;&#25509;&#24037;&#21378;&#65292;&#24182;&#19988;&#23558;&#20854;&#32465;&#23450;&#21040;
              JNDI&#20013;&#12290;&#22914;&#26524;&#38656;&#35201;&#21487;&#20197;&#23558;&#19968;&#20010;&#36830;&#25509;&#24037;&#21378;&#32465;&#23450;&#20026;&#22810;&#20010;&#21517;&#31216;&#12290;&#21482;&#38656;&#35201;&#23558;&#32465;&#23450;&#30340;&#21517;&#23383;&#21152;&#20837;&#21040; <tt class="literal">entry</tt> 
              &#20013;&#21363;&#21487;&#12290;</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>&#22312;JMS ConnectionFactory&#30340;&#37197;&#32622;&#20013;&#24341;&#29992;&#20102;&#19968;&#20010;&#21517;&#20026; <tt class="literal">netty</tt>&#30340;<tt class="literal">connector</tt>&#12290;
                &#23427;&#23454;&#38469;&#19978;&#25351;&#21521;&#30340;&#26159;HornetQ&#26680;&#24515;&#20013;&#37096;&#32626;&#30340;&#19968;&#20010;&#36830;&#25509;&#22120;&#65288;connector&#65289;&#12290;&#23427;&#30340;&#37197;&#32622;&#22312;HornetQ&#30340;&#26680;&#24515;&#37197;&#32622;&#25991;&#20214;
                 <tt class="literal">hornetq-configuration.xml</tt> &#20013;&#12290;&#23427;&#23450;&#20041;&#20102;&#37319;&#29992;&#20309;&#31181;&#20256;&#36755;&#19982;&#26381;&#21153;&#22120;&#36830;&#25509;&#12290;</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1020"></a>7.3.&nbsp;JNDI&#30340;&#37197;&#32622;</h2></div></div><div></div></div><p>&#24403;&#23458;&#25143;&#31471;&#20351;&#29992;JNDI&#26102;&#38656;&#35201;&#23450;&#20041;&#19968;&#20123;JNDI&#30340;&#21442;&#25968;&#12290;&#36825;&#20123;&#21442;&#25968;&#20027;&#35201;&#29992;&#26469;&#30830;&#23450;JNDI&#26381;&#21153;&#30340;&#22320;&#22336;&#12290;&#36825;&#20123;&#21442;&#25968;&#36890;&#24120;&#20445;&#23384;&#22312;
            &#19968;&#20010;&#21517;&#20026; <tt class="literal">jndi.properties</tt> &#30340;&#25991;&#20214;&#20013;&#12290;&#36825;&#20010;&#25991;&#20214;&#38656;&#35201;&#22312;&#23458;&#25143;&#31471;&#30340;classpath&#20013;&#12290;&#25110;&#32773;&#20320;
            &#21487;&#20197;&#22312;&#21019;&#24314;JNDI&#30340;InitialContext&#26102;&#23558;&#36825;&#20123;&#21442;&#25968;&#20256;&#36827;&#21435;&#12290;&#24819;&#20102;&#35299;&#20840;&#38754;&#30340;JNDI&#30693;&#35782;&#65292;&#21487;&#20197;&#21442;&#35265; <a href="http://java.sun.com/products/jndi/tutorial/TOC.html" target="_top">Sun JNDI &#25945;&#31243;</a>
            &#12290;</p><p>&#35201;&#19982;JBoss&#30340;JNDI Server&#36827;&#34892;&#36890;&#36805;&#65292;&#38656;&#35201;&#25351;&#23450;&#20197;&#19979;&#30340;JNDI&#21442;&#25968;&#65306;</p><pre class="programlisting">
java.naming.factory.initial=org.jnp.interfaces.NamingContextFactory
java.naming.provider.url=jnp://myhost:1099
java.naming.factory.url.pkgs=org.jboss.naming:org.jnp.interfaces                        
        </pre><p>&#20854;&#20013;&#30340; <tt class="literal">myhost</tt> &#26159; JNDI server&#30340;&#20027;&#26426;&#21517;&#25110;IP&#22320;&#22336;&#12290; 1099&#26159;&#31471;&#21475;&#21495;&#65292;&#26681;&#25454;&#19981;&#21516;&#30340;&#37197;&#32622;&#65292;
            &#31471;&#21475;&#21495;&#20063;&#21487;&#33021;&#19981;&#21516;&#12290;</p><p>&#22312;&#40664;&#35748;&#30340;&#21333;&#29420;&#26041;&#24335;&#65288;standalone&#65289;&#37197;&#32622;&#20013;&#65292;JNDI&#26381;&#21153;&#31471;&#21475;&#31561;&#21442;&#25968;&#23450;&#20041;&#22312;<tt class="literal">hornetq-beans.xml</tt>
              &#25991;&#20214;&#20013;&#30340; <tt class="literal">JNDIServer</tt> bean&#19979;&#65292;&#22914;&#65306;</p><pre class="programlisting">
&lt;bean name="JNDIServer" class="org.jnp.server.Main"&gt;
    &lt;property name="namingInfo"&gt;
        &lt;inject bean="Naming"/&gt;
    &lt;/property&gt;
    &lt;property name="port"&gt;1099&lt;/property&gt;
    &lt;property name="bindAddress"&gt;localhost&lt;/property&gt;
    &lt;property name="rmiPort"&gt;1098&lt;/property&gt;
    &lt;property name="rmiBindAddress"&gt;localhost&lt;/property&gt;
&lt;/bean&gt;                        
        </pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>&#22914;&#26524;&#20320;&#30340;JNDI&#26381;&#21153;&#22120;&#19982;&#23458;&#25143;&#31471;&#19981;&#22312;&#21516;&#19968;&#21488;&#26426;&#22120;&#19978;&#65292;&#19968;&#23450;&#19981;&#35201;&#24536;&#35760;&#23558;bindAddress&#25913;&#25104;&#30456;&#24212;&#30340;&#22320;&#22336;&#65292;
                  &#21315;&#19975;&#19981;&#33021;&#29992;<tt class="literal">localhost</tt>&#65281;</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><span class="emphasis"><em>&#21482;&#26377;&#24403;HornetQ&#20316;&#20026;&#29420;&#31435;&#26381;&#21153;&#22120;&#36816;&#34892;&#26102;</em></span>
                  &#25165;&#21487;&#20197;&#37197;&#32622;JNDIServer bean&#12290;&#24403;HornetQ&#36816;&#34892;&#20110;JBoss&#24212;&#29992;&#26381;&#21153;&#22120;&#20013;&#26102;&#65292;&#30001;&#20110;JBOSS&#26381;&#21153;&#22120;&#24050;&#32463;&#25552;&#20379;&#20102;
                  JNDI&#26381;&#21153;&#65292;&#25152;&#20197;&#23601;&#19981;&#38656;&#35201;&#20877;&#36827;&#34892;&#37197;&#32622;&#20102;&#12290;</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1061"></a>7.4.&nbsp;&#31243;&#24207;&#20195;&#30721;</h2></div></div><div></div></div><p>&#19979;&#38754;&#32473;&#20986;&#30340;&#20363;&#23376;&#20013;&#30340;&#20195;&#30721;&#65306;</p><p>&#39318;&#20808;&#25105;&#20204;&#21019;&#24314;&#19968;&#20010;JNDI&#30340;Initial Context&#65306;</p><pre class="programlisting">InitialContect ic = new InitialContext();</pre><p>&#19979;&#38754;&#25105;&#20204;&#26597;&#25214; connection factory&#65306;</p><pre class="programlisting">ConnectionFactory cf = (ConnectionFactory)ic.lookup("/ConnectionFactory");</pre><p>&#28982;&#21518;&#26597;&#25214; Queue&#65306;</p><pre class="programlisting">Queue orderQueue = (Queue)ic.lookup("/queues/OrderQueue");</pre><p>&#25509;&#19979;&#26469;&#29992;&#25343;&#21040;&#30340;ConnectionFactory&#24314;&#31435;JMS&#36830;&#25509;&#65306;</p><pre class="programlisting">Connection connection = cf.createConnection();</pre><p>&#20877;&#21019;&#24314;&#19968;&#20010;&#38750;&#20107;&#21153;&#30340;&#12289;AUTO_ACKNOWLEDGE&#26041;&#24335;&#30340;JMS Session&#65306;</p><pre class="programlisting">Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);</pre><p>&#21019;&#24314;&#19968;&#20010; MessageProducer &#20197;&#21521;&#38431;&#21015;&#21457;&#36865;&#35746;&#21333;&#28040;&#24687;&#65306;</p><pre class="programlisting">MessageProducer producer = session.createProducer(orderQueue);</pre><p>&#21019;&#24314;&#19968;&#20010; MessageConsumer &#20197;&#20174;&#38431;&#21015;&#20013;&#25509;&#25910;&#35746;&#21333;&#28040;&#24687;&#65306;</p><pre class="programlisting">MessageConsumer consumer = session.createConsumer(orderQueue);</pre><p>&#35201;&#21551;&#21160;&#36830;&#25509;&#65292;&#20197;&#20351;&#28040;&#24687;&#33021;&#20256;&#36882;&#32473;&#25509;&#25910;&#32773;&#65306;</p><pre class="programlisting">connection.start();</pre><p>&#21457;&#36865;&#19968;&#20010;&#31616;&#21333;&#30340;TextMessage&#65306;</p><pre class="programlisting">TextMessage message = session.createTextMessage("This is an order");
producer.send(message);</pre><p>&#20043;&#21518;&#25509;&#25910;&#36825;&#20010;&#28040;&#24687;&#65306;</p><pre class="programlisting">TextMessage receivedMessage = (TextMessage)consumer.receive();
System.out.println("Got order: " + receivedMessage.getText());
        </pre><p>&#30475;&#36215;&#26469;&#23601;&#26159;&#36825;&#20040;&#31616;&#21333;&#12290; &#22312;HornetQ&#26377;&#21457;&#24067;&#21253;&#20013;&#26377;&#24456;&#22810;&#21508;&#31181;&#21508;&#26679;&#30340;JMS&#20363;&#23376;&#20379;&#29992;&#25143;&#21442;&#32771;&#12290;</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>&#35831;&#27880;&#24847;&#65292;JMS&#30340;&#36830;&#25509;&#65288;connection&#65289;&#12289;&#20250;&#35805;&#65288;session&#65289;&#12289;&#29983;&#20135;&#32773;&#65288;producer&#65289;&#21644;&#28040;&#36153;&#32773;&#65288;consumer&#65289;
                  &#23545;&#35937;&#26159;&#21487;&#20197;<span class="emphasis"><em>&#37325;&#29992;</em></span>&#30340;&#12290;</p><p>&#22914;&#26524;&#27599;&#21457;&#36865;&#25110;&#25509;&#25910;&#19968;&#20010;&#28040;&#24687;&#37117;&#35201;&#37325;&#26032;&#21019;&#24314;&#36825;&#20123;JMS&#23545;&#35937;&#65292;&#26159;&#19981;&#31526;&#21512;&#35774;&#35745;&#27169;&#24335;&#30340;&#35201;&#27714;&#30340;&#12290;&#36825;&#26679;&#20570;&#20250;&#36896;&#25104;&#24212;&#29992;&#31243;&#24207;
                  &#30340;&#24615;&#33021;&#24456;&#24046;&#12290;&#36825;&#26041;&#38754;&#30340;&#20869;&#23481;&#22312;<a href="perf-tuning.html" title="Chapter&nbsp;46.&nbsp;&#24615;&#33021;&#35843;&#20248;">Chapter&nbsp;46, <i>&#24615;&#33021;&#35843;&#20248;</i></a>&#20013;&#23558;&#20250;&#36827;&#19968;&#27493;&#30340;&#35752;&#35770;&#12290;</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1118"></a>7.5.&nbsp;&#19981;&#20351;&#29992;JNDI&#32780;&#30452;&#25509;&#21019;&#24314;JMS&#30340;&#23545;&#35937;</h2></div></div><div></div></div><p>&#23613;&#31649;&#37319;&#29992;JNDI&#23545; JMS &#30340;&#21508;&#31181;<span class="emphasis"><em>&#31649;&#29702;&#23545;&#35937;&#65288;Administered
                Objects&#65289;</em></span> (&#21363;JMS Queue, Topic and ConnectionFactory)&#26159;&#24456;&#24120;&#29992;&#30340;&#26041;&#27861;&#65292;&#20294;&#22312;&#26377;&#20123;
            &#24773;&#20917;&#26102;JNDI&#19981;&#21487;&#29992;&#65292;&#25110;&#32773;&#20320;&#19981;&#38656;&#35201;&#29992;JNDI&#26102;&#65292;&#22914;&#20309;&#36824;&#33021;&#27491;&#24120;&#20351;&#29992;JMS&#21602;&#65311;</p><p>HornetQ&#20801;&#35768;&#20320;&#19981;&#36890;&#36807;JNDI&#20063;&#33021;&#20351;&#29992;JMS&#12290;HornetQ&#25903;&#25345;&#30452;&#25509;&#21019;&#24314;JMS&#30340;&#21508;&#31181;&#23545;&#35937;&#32780;&#26080;&#38656;JNDI&#30340;&#23384;&#22312;&#12290;</p><p>&#22312;<a href="examples.html" title="Chapter&nbsp;11.&nbsp;&#20363;&#23376;">Chapter&nbsp;11, <i>&#20363;&#23376;</i></a>&#20013;&#21253;&#25324;&#26377;&#36825;&#26679;&#30340;&#20363;&#23376;&#20379;&#35835;&#32773;&#21442;&#32771;&#12290;</p><p>&#19979;&#38754;&#25105;&#20204;&#23601;&#23558;&#19978;&#36848;&#37027;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#37325;&#20889;&#65292;&#20197;&#25243;&#24320;&#23545;JNDI&#30340;&#20381;&#36182;&#65306;</p><p>&#25105;&#20204;&#36890;&#36807;HornetQJMSClient&#31867;&#26469;&#26041;&#20415;&#22320;&#21019;&#24314;JMS&#30340;ConnectionFactory&#12290;&#27880;&#24847;&#36825;&#37324;&#35201;&#25552;&#20379;&#21508;&#31181;&#36830;&#25509;&#21442;&#25968;&#21644;&#23450;&#20041;
              &#25152;&#29992;&#30340;&#20256;&#36755;&#26041;&#24335;&#12290;&#26377;&#20851;&#36830;&#25509;&#22120;&#65288;connector&#65289;&#30340;&#20449;&#24687;&#21442;&#35265;<a href="configuring-transports.html" title="Chapter&nbsp;16.&nbsp;&#20256;&#36755;&#23618;&#30340;&#37197;&#32622;">Chapter&nbsp;16, <i>&#20256;&#36755;&#23618;&#30340;&#37197;&#32622;</i></a>&#12290;</p><pre class="programlisting">              
TransportConfiguration transportConfiguration = 
                     new TransportConfiguration(NettyConnectorFactory.class.getName());                
ConnectionFactory cf = HornetQJMSClient.createConnectionFactory(transportConfiguration);
        </pre><p>&#21516;&#26679;&#21033;&#29992;HornetQJMSClient&#31867;&#21019;&#24314;JMS Queue&#23545;&#35937;&#65306;</p><pre class="programlisting">Queue orderQueue = HornetQJMSClient.createQueue("OrderQueue");</pre><p>&#28982;&#21518;&#29992;&#36830;&#25509;&#24037;&#21378;&#21019;&#24314; JMS &#36830;&#25509;&#65306;</p><pre class="programlisting">Connection connection = cf.createConnection();</pre><p>&#36824;&#26377;&#38750;&#20107;&#21153;&#30340;\AUTO_ACKNOWLEDGE&#26041;&#24335;&#30340; JMS &#20250;&#35805;&#65288;session&#65289;&#65306;</p><pre class="programlisting">Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);</pre><p>&#20197;&#21450;&#29992;&#20110;&#21457;&#36865;&#28040;&#24687;&#30340;MessageProducer&#65306;</p><pre class="programlisting">MessageProducer producer = session.createProducer(orderQueue);</pre><p>&#21644;&#25509;&#25910;&#28040;&#24687;&#30340; MessageConsumer&#65306;</p><pre class="programlisting">MessageConsumer consumer = session.createConsumer(orderQueue);</pre><p>&#21551;&#21160;&#36830;&#25509;&#65306;</p><pre class="programlisting">connection.start();</pre><p>&#21019;&#24314;&#19968;&#20010;&#31616;&#21333;&#30340; TextMessage &#24182;&#23558;&#20854;&#21457;&#36865;&#21040;&#38431;&#21015;&#65306;</p><pre class="programlisting">TextMessage message = session.createTextMessage("This is an order");
producer.send(message);</pre><p>&#25509;&#25910;&#28040;&#24687;&#65306;</p><pre class="programlisting">TextMessage receivedMessage = (TextMessage)consumer.receive();
System.out.println("Got order: " + receivedMessage.getText());
        </pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="using-jms.clientid"></a>7.6.&nbsp;Client ID&#30340;&#35774;&#32622;</h2></div></div><div></div></div><p>&#22312;&#24314;&#31435;&#25345;&#20037;&#30340;&#35746;&#38405;&#65288;subscription&#65289;&#26102;&#65292;JMS&#23458;&#25143;&#38656;&#35201;&#26377;&#19968;&#20010;&#23458;&#25143;ID &#65288;client id&#65289;&#12290;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#37197;&#32622;
            connection factory&#26469;&#23450;&#20041;&#23427;&#12290;&#65288;&#20854;&#20013;&#30340; <tt class="literal">client-id</tt>&#39033;&#65289;&#12290;&#36825;&#26679;&#25152;&#26377;&#36890;&#36807;&#36825;&#20010;
            connection factory&#26469;&#21019;&#24314;&#30340;&#36830;&#25509;&#37117;&#20855;&#26377;&#36825;&#20010;&#23458;&#25143;ID&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="using-jms.dupsokbatchsize"></a>7.7.&nbsp;&#35774;&#32622;DUPS_OK&#30340;Batch Size </h2></div></div><div></div></div><p>&#22914;&#26524;JMS&#30340;&#36890;&#30693;&#27169;&#24335;&#20026;<tt class="literal">DUPS_OK</tt>&#65292;&#25105;&#20204;&#21487;&#20197;&#37197;&#32622;&#25509;&#25910;&#32773;&#65288;consumer&#65289;&#20197;&#20351;&#24471;&#23427;&#20197;&#25209;&#20026;&#21333;&#20301;
            &#21457;&#36865;&#36890;&#30693;&#65292;&#32780;&#19981;&#26159;&#19968;&#20010;&#19968;&#20010;&#22320;&#21457;&#36890;&#30693;&#12290;&#36825;&#26679;&#20570;&#21487;&#20197;&#33410;&#30465;&#24456;&#22810;&#24102;&#23485;&#65292;&#25928;&#29575;&#39640;&#12290;&#37197;&#32622;&#30340;&#26041;&#27861;&#26159;&#35774;&#32622;connection factory&#19979;
            &#30340;<tt class="literal">dups-ok-batch-size</tt>&#39033;&#12290;&#21333;&#20301;&#26159;&#23383;&#33410;&#65288;byte&#65289;&#12290;&#40664;&#35748;&#20540;&#26159;1024 * 1024 bytes = 1 MiB&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="using-jms.txbatchsize"></a>7.8.&nbsp;&#35774;&#32622;&#20107;&#21153;&#65288;Transaction&#65289;&#30340;Batch Size</h2></div></div><div></div></div><p>&#24403;&#22312;&#19968;&#20010;&#20107;&#21153;&#20869;&#25509;&#25910;&#28040;&#24687;&#26102;&#65292;&#21487;&#33021;&#36890;&#36807;&#37197;&#32622;&#20351;&#25509;&#25910;&#32773;&#37319;&#29992;&#25209;&#37327;&#30340;&#26041;&#24335;&#21457;&#36865;&#36890;&#30693;&#65292;&#32780;&#19981;&#26159;&#19968;&#20010;&#19968;&#20010;&#30340;&#21457;&#36865;&#12290;&#36825;&#26679;&#20063;&#21487;&#20197;&#33410;&#30465;&#24102;&#23485;&#12290;
            &#37197;&#32622;&#26041;&#27861;&#26159;&#35774;&#32622;connection factory&#19979;&#30340;<tt class="literal">transaction-batch-size</tt>&#39033;&#12290; &#21333;&#20301;&#26159;&#23383;&#33410;&#65288;byte&#65289;&#12290;&#40664;&#35748;&#20540;&#26159;1024 *
            1024&#12290;</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="using-server.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="using-core.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;6.&nbsp;&#20351;&#29992;HornetQ&#26381;&#21153;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;8.&nbsp;&#20351;&#29992;HornetQ&#20869;&#26680;</td></tr></table></div></body></html>